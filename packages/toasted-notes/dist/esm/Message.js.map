{"version":3,"file":"Message.js","names":["React","useTransition","animated","ReachAlert","Alert","useTimeout","getStyle","position","style","display","flexDirection","alignItems","includes","Message","id","message","onRequestRemove","requestClose","duration","container","useRef","timeout","setTimeout","useState","localShow","setLocalShow","isFromTop","close","animation","config","mass","tension","friction","from","opacity","height","transform","enter","next","current","getBoundingClientRect","leave","onRest","transition","useMemo","onMouseEnter","onMouseLeave","useEffect","renderMessage","isValidElement","onClose","props","item","pointerEvents"],"sources":["../../src/Message.tsx"],"sourcesContent":["import * as React from \"react\";\nimport { useTransition, animated } from \"react-spring\";\nimport ReachAlert from \"@reach/alert\";\nimport Alert from \"./Alert\";\nimport { useTimeout } from \"./useTimeout\";\nimport POSITIONS from \"./Positions\";\n\ninterface MessageCallback {\n  id: string;\n  onClose: () => void;\n}\n\nexport type MessageType = \"default\" | \"success\" | \"error\";\n\nexport type PositionsType = keyof typeof POSITIONS;\n\nconst getStyle = (position: PositionsType) => {\n  let style = {\n    display: \"flex\",\n    flexDirection: \"column\",\n    alignItems: \"center\",\n  } as React.CSSProperties;\n\n  if (position.includes(\"right\")) {\n    style.alignItems = \"flex-end\";\n  } else if (position.includes(\"left\")) {\n    style.alignItems = \"flex-start\";\n  }\n\n  return style;\n};\n\nexport type MessageProp =\n  | React.ReactNode\n  | ((callback: MessageCallback) => React.ReactNode)\n  | string;\n\nexport interface MessageOptions {\n  id: string;\n  duration: number | null;\n  type: MessageType;\n  onRequestRemove: () => void;\n  onRequestClose: () => void;\n  showing: boolean;\n  position: PositionsType;\n}\n\ninterface Props extends MessageOptions {\n  message: MessageProp;\n  zIndex?: number;\n  requestClose?: boolean;\n  position: PositionsType;\n}\n\nexport const Message = ({\n  id,\n  message,\n  position,\n  onRequestRemove,\n  requestClose = false,\n  duration = 30000,\n}: Props) => {\n  const container = React.useRef<HTMLDivElement | null>(null);\n  const [timeout, setTimeout] = React.useState(duration);\n  const [localShow, setLocalShow] = React.useState(true);\n\n  const isFromTop =\n    position === \"top-left\" || position === \"top-right\" || position === \"top\";\n\n  useTimeout(close, timeout);\n\n  const animation = {\n    config: { mass: 1, tension: 185, friction: 26 },\n    from: {\n      opacity: 1,\n      height: 0,\n      transform: `translateY(${isFromTop ? \"-100%\" : 0}) scale(1)`,\n    },\n    enter: () => (next: any) =>\n      next({\n        opacity: 1,\n        height: container.current!.getBoundingClientRect().height,\n        transform: `translateY(0) scale(1)`,\n      }),\n    leave: {\n      opacity: 0,\n      height: 0,\n      transform: `translateY(0 scale(0.9)`,\n    },\n    onRest,\n  } as any;\n\n  const transition = useTransition(localShow, animation);\n  const style = React.useMemo(() => getStyle(position), [position]);\n\n  function onMouseEnter() {\n    setTimeout(null);\n  }\n\n  function onMouseLeave() {\n    setTimeout(duration);\n  }\n\n  function onRest() {\n    if (!localShow) {\n      onRequestRemove();\n    }\n  }\n\n  function close() {\n    setLocalShow(false);\n  }\n\n  React.useEffect(() => {\n    if (requestClose) {\n      setLocalShow(false);\n    }\n  }, [requestClose]);\n\n  function renderMessage() {\n    if (typeof message === \"string\" || React.isValidElement(message)) {\n      return <Alert id={id} title={message} onClose={close} />;\n    }\n\n    if (typeof message === \"function\") {\n      return message({\n        id,\n        onClose: close,\n      });\n    }\n\n    return null;\n  }\n\n  return (\n    <React.Fragment>\n      {transition(\n        (props, item) =>\n          item && (\n            <animated.div\n              className=\"Toaster__message\"\n              onMouseEnter={onMouseEnter}\n              onMouseLeave={onMouseLeave}\n              style={{\n                opacity: props.opacity,\n                height: props.height,\n                ...style,\n              }}\n            >\n              <animated.div\n                style={{\n                  transform: props.transform,\n                  pointerEvents: \"auto\",\n                }}\n                ref={container}\n                className=\"Toaster__message-wrapper\"\n              >\n                <ReachAlert>{renderMessage()}</ReachAlert>\n              </animated.div>\n            </animated.div>\n          )\n      )}\n    </React.Fragment>\n  );\n};\n"],"mappings":"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"}