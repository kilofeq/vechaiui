{"version":3,"file":"ToastManager.js","names":["React","Message","defaultState","top","bottom","ToastManager","Component","constructor","props","state","notify","message","options","toast","createToastState","position","isTop","includes","setState","prev","id","closeAll","Object","keys","forEach","pos","p","closeToast","idCounter","hasOwnProperty","showing","duration","onRequestRemove","removeToast","String","type","map","requestClose","filter","getStyle","style","maxWidth","zIndex","pointerEvents","margin","textAlign","right","left","render","toasts"],"sources":["../../src/ToastManager.tsx"],"sourcesContent":["import * as React from \"react\";\nimport {\n  Message,\n  PositionsType,\n  MessageType,\n  MessageOptions,\n  MessageProp\n} from \"./Message\";\n\ninterface Props {\n  notify: (fn: Function, closeAll: Function, close: Function) => void;\n}\n\nexport interface MessageOptionalOptions {\n  type?: MessageType;\n  duration?: number | null;\n  position?: PositionsType;\n}\n\ninterface ToastArgs extends MessageOptions {\n  message: MessageProp;\n}\n\ntype State = {\n  top: Array<ToastArgs>;\n  \"top-left\": Array<ToastArgs>;\n  \"top-right\": Array<ToastArgs>;\n  \"bottom-left\": Array<ToastArgs>;\n  bottom: Array<ToastArgs>;\n  \"bottom-right\": Array<ToastArgs>;\n};\n\nconst defaultState: State = {\n  top: [],\n  \"top-left\": [],\n  \"top-right\": [],\n  \"bottom-left\": [],\n  bottom: [],\n  \"bottom-right\": []\n};\n\ntype Keys = keyof State;\n\nexport default class ToastManager extends React.Component<Props, State> {\n  static idCounter = 0;\n\n  state: State = defaultState;\n\n  constructor(props: Props) {\n    super(props);\n    props.notify(this.notify, this.closeAll, this.closeToast);\n  }\n\n  notify = (message: MessageProp, options: MessageOptionalOptions) => {\n    const toast = this.createToastState(message, options);\n    const { position } = toast;\n\n    // prepend the toast for toasts positioned at the top of\n    // the screen, otherwise append it.\n    const isTop = position.includes(\"top\");\n\n    this.setState(prev => {\n      return {\n        ...prev,\n        [position]: isTop\n          ? [toast, ...prev[position]]\n          : [...prev[position], toast]\n      };\n    });\n    return { id: toast.id, position: toast.position };\n  };\n\n  closeAll = () => {\n    Object.keys(this.state).forEach(pos => {\n      const p = pos as keyof State;\n      const position = this.state[p];\n      position.forEach((toast: any) => {\n        this.closeToast(toast.id, p);\n      });\n    });\n  };\n\n  createToastState = (\n    message: MessageProp,\n    options: MessageOptionalOptions\n  ) => {\n    const id = ++ToastManager.idCounter;\n\n    // a bit messy, but object.position returns a number because\n    // it's a method argument.\n    const position =\n      options.hasOwnProperty(\"position\") && typeof options.position === \"string\"\n        ? options.position\n        : \"top\";\n\n    return {\n      id,\n      message,\n      position,\n      showing: true,\n      duration:\n        typeof options.duration === \"undefined\" ? 5000 : options.duration,\n      onRequestRemove: () => this.removeToast(String(id), position),\n      type: options.type\n    };\n  };\n\n  closeToast = (id: string, position: PositionsType) => {\n    this.setState(prev => {\n      return {\n        ...prev,\n        [position]: prev[position].map(toast => {\n          if (toast.id !== id) return toast;\n          return {\n            ...toast,\n            requestClose: true\n          };\n        })\n      };\n    });\n  };\n\n  // actually fully remove the toast\n  removeToast = (id: string, position: PositionsType) => {\n    this.setState(prev => {\n      return {\n        ...prev,\n        [position]: prev[position].filter(toast => toast.id !== id)\n      };\n    });\n  };\n\n  getStyle = (position: PositionsType) => {\n    let style: React.CSSProperties = {\n      maxWidth: \"560px\",\n      position: \"fixed\",\n      zIndex: 5500,\n      pointerEvents: \"none\"\n    };\n\n    if (position === \"top\" || position === \"bottom\") {\n      style.margin = \"0 auto\";\n      style.textAlign = \"center\";\n    }\n\n    if (position.includes(\"top\")) {\n      style.top = 0;\n    }\n\n    if (position.includes(\"bottom\")) {\n      style.bottom = 0;\n    }\n\n    if (!position.includes(\"left\")) {\n      style.right = 0;\n    }\n\n    if (!position.includes(\"right\")) {\n      style.left = 0;\n    }\n\n    return style;\n  };\n\n  render() {\n    return Object.keys(this.state).map(position => {\n      const pos = position as keyof State;\n      const toasts = this.state[pos];\n      return (\n        <span\n          key={position}\n          className={\"Toaster__manager-\" + pos}\n          style={this.getStyle(pos)}\n        >\n          {toasts.map((toast: ToastArgs) => {\n            return <Message {...toast} position={pos} key={toast.id} />;\n          })}\n        </span>\n      );\n    });\n  }\n}\n"],"mappings":"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"}