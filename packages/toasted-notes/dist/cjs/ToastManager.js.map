{"version":3,"file":"ToastManager.js","names":["defaultState","top","bottom","ToastManager","props","state","notify","message","options","toast","createToastState","position","isTop","includes","setState","prev","id","closeAll","Object","keys","forEach","pos","p","closeToast","idCounter","hasOwnProperty","showing","duration","onRequestRemove","removeToast","String","type","map","requestClose","filter","getStyle","style","maxWidth","zIndex","pointerEvents","margin","textAlign","right","left","render","toasts","React","Component"],"sources":["../../src/ToastManager.tsx"],"sourcesContent":["import * as React from \"react\";\nimport {\n  Message,\n  PositionsType,\n  MessageType,\n  MessageOptions,\n  MessageProp\n} from \"./Message\";\n\ninterface Props {\n  notify: (fn: Function, closeAll: Function, close: Function) => void;\n}\n\nexport interface MessageOptionalOptions {\n  type?: MessageType;\n  duration?: number | null;\n  position?: PositionsType;\n}\n\ninterface ToastArgs extends MessageOptions {\n  message: MessageProp;\n}\n\ntype State = {\n  top: Array<ToastArgs>;\n  \"top-left\": Array<ToastArgs>;\n  \"top-right\": Array<ToastArgs>;\n  \"bottom-left\": Array<ToastArgs>;\n  bottom: Array<ToastArgs>;\n  \"bottom-right\": Array<ToastArgs>;\n};\n\nconst defaultState: State = {\n  top: [],\n  \"top-left\": [],\n  \"top-right\": [],\n  \"bottom-left\": [],\n  bottom: [],\n  \"bottom-right\": []\n};\n\ntype Keys = keyof State;\n\nexport default class ToastManager extends React.Component<Props, State> {\n  static idCounter = 0;\n\n  state: State = defaultState;\n\n  constructor(props: Props) {\n    super(props);\n    props.notify(this.notify, this.closeAll, this.closeToast);\n  }\n\n  notify = (message: MessageProp, options: MessageOptionalOptions) => {\n    const toast = this.createToastState(message, options);\n    const { position } = toast;\n\n    // prepend the toast for toasts positioned at the top of\n    // the screen, otherwise append it.\n    const isTop = position.includes(\"top\");\n\n    this.setState(prev => {\n      return {\n        ...prev,\n        [position]: isTop\n          ? [toast, ...prev[position]]\n          : [...prev[position], toast]\n      };\n    });\n    return { id: toast.id, position: toast.position };\n  };\n\n  closeAll = () => {\n    Object.keys(this.state).forEach(pos => {\n      const p = pos as keyof State;\n      const position = this.state[p];\n      position.forEach((toast: any) => {\n        this.closeToast(toast.id, p);\n      });\n    });\n  };\n\n  createToastState = (\n    message: MessageProp,\n    options: MessageOptionalOptions\n  ) => {\n    const id = ++ToastManager.idCounter;\n\n    // a bit messy, but object.position returns a number because\n    // it's a method argument.\n    const position =\n      options.hasOwnProperty(\"position\") && typeof options.position === \"string\"\n        ? options.position\n        : \"top\";\n\n    return {\n      id,\n      message,\n      position,\n      showing: true,\n      duration:\n        typeof options.duration === \"undefined\" ? 5000 : options.duration,\n      onRequestRemove: () => this.removeToast(String(id), position),\n      type: options.type\n    };\n  };\n\n  closeToast = (id: string, position: PositionsType) => {\n    this.setState(prev => {\n      return {\n        ...prev,\n        [position]: prev[position].map(toast => {\n          if (toast.id !== id) return toast;\n          return {\n            ...toast,\n            requestClose: true\n          };\n        })\n      };\n    });\n  };\n\n  // actually fully remove the toast\n  removeToast = (id: string, position: PositionsType) => {\n    this.setState(prev => {\n      return {\n        ...prev,\n        [position]: prev[position].filter(toast => toast.id !== id)\n      };\n    });\n  };\n\n  getStyle = (position: PositionsType) => {\n    let style: React.CSSProperties = {\n      maxWidth: \"560px\",\n      position: \"fixed\",\n      zIndex: 5500,\n      pointerEvents: \"none\"\n    };\n\n    if (position === \"top\" || position === \"bottom\") {\n      style.margin = \"0 auto\";\n      style.textAlign = \"center\";\n    }\n\n    if (position.includes(\"top\")) {\n      style.top = 0;\n    }\n\n    if (position.includes(\"bottom\")) {\n      style.bottom = 0;\n    }\n\n    if (!position.includes(\"left\")) {\n      style.right = 0;\n    }\n\n    if (!position.includes(\"right\")) {\n      style.left = 0;\n    }\n\n    return style;\n  };\n\n  render() {\n    return Object.keys(this.state).map(position => {\n      const pos = position as keyof State;\n      const toasts = this.state[pos];\n      return (\n        <span\n          key={position}\n          className={\"Toaster__manager-\" + pos}\n          style={this.getStyle(pos)}\n        >\n          {toasts.map((toast: ToastArgs) => {\n            return <Message {...toast} position={pos} key={toast.id} />;\n          })}\n        </span>\n      );\n    });\n  }\n}\n"],"mappings":"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"}